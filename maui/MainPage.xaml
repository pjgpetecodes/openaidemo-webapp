<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:components="clr-namespace:maui.Components;assembly=maui"
             xmlns:local="clr-namespace:maui.ViewModels;assembly=maui"
             xmlns:selectors="clr-namespace:maui.ViewModels;assembly=maui"
             x:Class="maui.MainPage">


    <ContentPage.Resources>
        <ResourceDictionary>
            <DataTemplate x:Key="UserMessageTemplate">
                <ViewCell>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <components:ChatBubble Message="{Binding}" Grid.Column="0" />
                    </Grid>
                </ViewCell>
            </DataTemplate>

            <DataTemplate x:Key="AIMessageTemplate">
                <ViewCell>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <components:ChatBubble Message="{Binding}" Grid.Column="1" />
                    </Grid>
                </ViewCell>
            </DataTemplate>
        </ResourceDictionary>
    </ContentPage.Resources>
    
    <ContentPage.BindingContext>
        <local:ChatViewModel />
    </ContentPage.BindingContext>
    
    <ScrollView >
        <VerticalStackLayout
            Padding="30,0"
            Spacing="25">

            <VerticalStackLayout>
                <Label Text="Company:" />
                <Picker x:Name="company" SelectedItem="{Binding SelectedCompany}" ItemsSource="{Binding Companies}" />

                <ListView ItemsSource="{Binding ChatMessages}" ItemTemplate="{StaticResource selectors.MessageTemplateSelector}" />

                <!--
                <ListView ItemsSource="{Binding ChatMessages}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <ViewCell>
                                <StackLayout Orientation="Horizontal">
                                    <Label Text="{Binding Content}" TextColor="Blue" />
                                </StackLayout>
                            </ViewCell>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                -->
                <!-- Add a text input for a chat message -->
                <Entry x:Name="chatInput" Text="{Binding ChatMessage}" Placeholder="Chat Message" />
                <Button Text="Send Test Message" Clicked="SendTestMessage" />


            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
